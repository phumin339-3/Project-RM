<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Phishing URL Checker</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">


  <style>
    html, body {
      margin: 0;
      padding: 0;
    }

    /* ========= THEME: Light is default ========= */
    :root{
      /* light palette */
      --bg: #f5f7fb;
      --bg-grad: radial-gradient(900px 520px at 50% -120px, #ffffff 0%, #f5f7fb 70%);
      --muted: #4b5563;
      --ink: #0e1117;
      --accent: #2b6bff;
      --ring: rgba(43, 107, 255, .22);
      --glass: rgba(0,0,0,.03);
      --glass-2: rgba(0,0,0,.015);
      --radius: 22px;
      --shadow: 0 16px 48px rgba(20, 24, 40, .08);

      /* motion */
      --from-offset: 46px;
      --panel-nudge: 24px;
      --anim-dur: .55s;
      --anim-ease: cubic-bezier(.2,.9,.2,1);

      /* surfaces */
      --card: #ffffff;
      --line: rgba(15,23,42,.08);
      --ink-soft: #111827;
    }

    /* ========= DARK THEME OVERRIDES ========= */
    .theme-dark{
      --bg: #0e1117;
      --bg-grad: radial-gradient(1000px 600px at 50% -100px, #1a2236 0%, #0e1117 70%);
      --muted: #9fb3d2;
      --ink: #e9f0ff;
      --accent: #2b6bff;
      --ring: rgba(0, 186, 255, .35);
      --glass: rgba(255,255,255,.06);
      --glass-2: rgba(255,255,255,.03);
      --shadow: 0 20px 60px rgba(0,0,0,.45);
      --card: rgba(255,255,255,.04);
      --line: rgba(255,255,255,.08);
      --ink-soft: #e6edff;
    }

    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: var(--bg);
      background-image: var(--bg-grad);
    }

    body{ transition: background .35s ease, color .35s ease; }
    .app{ max-width:1180px; margin:72px auto 48px; }

    .brand{
      font-weight:800; letter-spacing:.3px; color:var(--ink);
      text-shadow: none;
    }
    .theme-dark .brand{
      color:#fff;
      text-shadow: 0 0 16px rgba(0,209,255,.35);
    }

    /* ===== Top-right slide switch ===== */
    .mode-toggle{
      position: fixed; right: 18px; top: 18px; z-index: 2000;
      display:flex; align-items:center; gap:10px; user-select:none;
      font-weight:600; color:var(--muted);
      background: linear-gradient(180deg, var(--glass), var(--glass-2));
      border-radius: 999px; padding:10px 14px; box-shadow: var(--shadow);
      border:1px solid var(--line);
      backdrop-filter: blur(8px);
    }
    .toggle{
      width:56px; height:30px; border-radius:999px; position:relative; cursor:pointer;
      background: #e5e7eb; transition: background .25s ease, box-shadow .25s ease;
      box-shadow: inset 0 2px 6px rgba(0,0,0,.08);
    }
    .toggle::after{
      content:""; position:absolute; top:3px; left:3px; width:24px; height:24px; border-radius:999px;
      background:#ffffff; box-shadow: 0 4px 10px rgba(0,0,0,.15);
      transition: transform .25s ease;
    }
    .toggle.active{ background:#3457ff33; box-shadow: inset 0 2px 10px rgba(43,107,255,.25); }
    .toggle.active::after{ transform: translateX(26px); }
    .mode-toggle .label{ min-width:84px; text-align:right; }
    

    /* ===== URL BAR ===== */
    .url-wrap{
      background: linear-gradient(180deg, var(--glass), var(--glass-2));
      border-radius: var(--radius);
      box-shadow: var(--shadow), 0 0 0 1px var(--line) inset;
      padding:18px; position: relative; overflow: visible;
      backdrop-filter: blur(6px);
    }
    .form-label{ color:var(--muted); }
    .form-control{
      color:var(--ink); background:#ffffff;
      border:1px solid var(--line); border-radius:12px; height:52px;
      backdrop-filter: blur(8px);
    }
    .theme-dark .form-control{
      color:var(--ink); background:rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.08);
    }
    .form-control::placeholder{ color:#98a2b3; }
    .form-control:focus{
      color:var(--ink); border-color:transparent;
      box-shadow: 0 0 0 4px var(--ring);
      background:#fff;
    }
    .theme-dark .form-control:focus{
      color:#fff; background:rgba(255,255,255,.05);
      box-shadow: 0 0 0 4px var(--ring), 0 0 18px rgba(0,209,255,.25);
    }

    /* ===== RESULT under URL ===== */
    .result-alert{
      border-radius:14px; margin-top:12px; padding:12px 14px; color:var(--ink);
      background: linear-gradient(180deg, rgba(43,107,255,.06), rgba(0,0,0,.01));
      box-shadow: 0 0 0 1px var(--line) inset, var(--shadow);
      backdrop-filter: blur(6px);
    }
    .theme-dark .result-alert{ color:#e9eefc; }
    .result-alert.safe{
      background: linear-gradient(180deg, rgba(45,255,171,.12), rgba(0,0,0,.01));
      box-shadow: 0 0 24px rgba(45,255,171,.18), 0 0 0 1px rgba(45,255,171,.25) inset;
    }
    .result-alert.suspicious{
      background: linear-gradient(180deg, rgba(255,200,0,.12), rgba(0,0,0,.01));
      box-shadow: 0 0 24px rgba(255,200,0,.18), 0 0 0 1px rgba(255,200,0,.25) inset;
    }
    .result-alert.unsafe{
      background: linear-gradient(180deg, rgba(255,77,77,.12), rgba(0,0,0,.01));
      box-shadow: 0 0 24px rgba(255,77,77,.18), 0 0 0 1px rgba(255,77,77,.25) inset;
    }

    /* ===== LAYOUT ===== */
    .tri{
      display:grid; grid-template-columns:1fr 200px 1fr; gap:24px;
      margin-top:26px; align-items:stretch; position:relative;
    }

    /* ===== ROUND CHECK BUTTON ===== */
    .round-btn{
      width:200px; height:200px; border-radius:999px; border:0;
      background: radial-gradient(115% 115% at 30% 20%, #e9ecff, #cfd8ff 70%);
      color:#1f2538; font-weight:800; letter-spacing:.2px;
      box-shadow:
        inset 0 30px 90px rgba(255,255,255,.6),
        0 16px 40px rgba(20,24,40,.22),
        0 0 36px rgba(43, 107, 255, .18);
      transition: transform .22s ease, box-shadow .22s ease;
      display:flex; align-items:center; justify-content:center; flex-direction:column;
      position:relative; text-transform:uppercase; outline: 0;
    }
    .theme-dark .round-btn{
      background: radial-gradient(115% 115% at 30% 20%, #28418b, #1c2c64 70%);
      color:#f7f9ff;
      box-shadow:
        inset 0 30px 90px rgba(255,255,255,.06),
        0 16px 40px rgba(0,0,0,.55),
        0 0 48px rgba(0, 186, 255, .25);
    }
    .round-btn.active{
      background:
        radial-gradient(120% 120% at 30% 20%, var(--accent), #7b94ff 70%),
        linear-gradient(180deg, rgba(255,255,255,.2), transparent);
      color:#fff;
      box-shadow:
        0 22px 50px rgba(20,24,40,.25),
        0 0 64px rgba(43, 107, 255, .40),
        0 0 0 6px rgba(43, 107, 255, .10);
    }
    .theme-dark .round-btn.active{
      background:
        radial-gradient(120% 120% at 30% 20%, var(--accent), #153a9b 70%),
        linear-gradient(180deg, rgba(255,255,255,.1), transparent);
      box-shadow:
        0 22px 50px rgba(0,0,0,.6),
        0 0 64px rgba(0, 186, 255, .40),
        0 0 0 6px rgba(0, 186, 255, .10);
    }
    .round-btn:hover:not(:disabled),
    .round-btn:focus-visible{
      transform: translateY(-4px) scale(1.02);
      box-shadow:
        0 24px 56px rgba(20,24,40,.26),
        0 0 76px rgba(43,107,255,.35),
        0 0 0 8px rgba(43,107,255,.08);
    }
    .theme-dark .round-btn:hover:not(:disabled),
    .theme-dark .round-btn:focus-visible{
      box-shadow:
        0 24px 56px rgba(0,0,0,.6),
        0 0 76px rgba(0,186,255,.45),
        0 0 0 8px rgba(0,186,255,.10);
    }
    .round-btn .pct{ font-size:22px; margin-top:6px; opacity:.95; }
    .spinner{
      position:absolute; inset:16px; border-radius:999px;
      border:6px solid rgba(0,0,0,.08);
      border-top-color:#111827; animation:spin .9s linear infinite; display:none;
      filter: drop-shadow(0 0 4px rgba(0,0,0,.1));
    }
    .theme-dark .spinner{
      border:6px solid rgba(255,255,255,.18); border-top-color:#fff;
      filter: drop-shadow(0 0 8px rgba(255,255,255,.35));
    }
    .round-btn.loading .spinner{ display:block; }
    @keyframes spin{ to{ transform:rotate(360deg); } }

    /* ===== PANELS ===== */
    .panel{
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: 0 10px 35px rgba(20,24,40,.10);
      position: relative; padding: 12px 14px 16px;
      backdrop-filter: blur(10px) saturate(120%);
      transition: transform .5s var(--anim-ease), opacity .5s var(--anim-ease), filter .5s var(--anim-ease), box-shadow .5s var(--anim-ease);
      border: 1px solid var(--line);
    }
    .panel::before{
      content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none;
      box-shadow: 0 0 0 1px var(--line) inset;
      transition: opacity .5s var(--anim-ease);
      opacity:.9;
    }

    #panelInfo  { transform: translateX(var(--panel-nudge));   opacity:.96; filter: blur(0.3px); }
    #panelReason{ transform: translateX(calc(var(--panel-nudge) * -1)); opacity:.96; filter: blur(0.3px); }

    .peek-left  #panelInfo,
    .peek-right #panelReason,
    .reveal #panelInfo,
    .reveal #panelReason,
    #panelInfo.locked,
    #panelReason.locked{
      transform: translateX(0);
      opacity:1;
      filter: none;
    }

    .head{ display:flex; align-items:center; justify-content:space-between; gap:8px; padding-bottom:8px; color:var(--ink); }
    .theme-dark .head{ color:#e9eefc; }
    .title{ display:flex; gap:10px; align-items:center; font-weight:700; }
    .title svg{ width:18px; height:18px; color:#2563eb; }
    .theme-dark .title svg{ color:#77cfff; }

    .lock{
      display:inline-flex; align-items:center; justify-content:center;
      width:38px; height:38px; border-radius:12px; border:0;
      background:#eef2ff; color:#334155; transition:all .2s ease;
      box-shadow: 0 0 0 1px var(--line) inset;
    }
    .lock:hover{ color:#111827; box-shadow:0 0 0 1px rgba(43,107,255,.35) inset, 0 0 14px rgba(43,107,255,.20); }
    .theme-dark .lock{ background:rgba(0,0,0,.18); color:#aeb7ca; }
    .theme-dark .lock:hover{ color:#e6edff; box-shadow:0 0 0 1px rgba(0,186,255,.35) inset, 0 0 14px rgba(0,186,255,.20); }
    .lock svg{ width:18px; height:18px; }

    .list{ margin:0; padding-left:18px; color:var(--ink-soft); }
    .theme-dark .list{ color:#cfe3ff; }
    .list li{ margin:.25rem 0; opacity:0.98; }

    .drawer{ position:relative; overflow:hidden; }
    .drawer-inner{ padding:6px 2px 2px; transition: transform .5s var(--anim-ease), opacity .5s var(--anim-ease), filter .5s var(--anim-ease); }

    #panelInfo  .drawer-inner{ transform: translateX(var(--from-offset));  opacity:.0; filter: blur(2px); }
    #panelReason .drawer-inner{ transform: translateX(calc(var(--from-offset) * -1)); opacity:.0; filter: blur(2px); }

    .peek-left  #panelInfo  .drawer-inner,
    .peek-right #panelReason .drawer-inner,
    .reveal #panelInfo  .drawer-inner,
    .reveal #panelReason .drawer-inner,
    #panelInfo.locked  .drawer-inner,
    #panelReason.locked .drawer-inner{
      transform: translateX(0); opacity:1; filter: blur(0);
    }

    #disclaimerBtnContainer {
      position: absolute;
      bottom: -50px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 100;
      display: block;
    }

    #panelInfo h6 { display:none; }
    h6 { color: var(--ink); text-shadow: none; }
    .theme-dark h6 { color: #ffffff; text-shadow: 0 0 8px rgba(0, 186, 255, 0.6), 0 0 15px rgba(0, 186, 255, 0.8); }

    /* small screens */
    @media (max-width: 992px){
      .tri{ grid-template-columns:1fr; }
      #disclaimerBtnContainer{ position: static; transform:none; margin-top:12px; }
      .mode-toggle{ right: 12px; top: 12px; }
    }

    .profile-google {
      background: transparent !important;
      border: 1px solid var(--line) !important;
    }
    .auth-wrapper{
      position: relative;
      min-height: 360px;
      overflow: hidden;
    }

    .auth-page{
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      transition: opacity .25s ease, transform .25s ease;
    }

    .auth-page.hide{
      opacity: 0;
      transform: translateX(16px);
      pointer-events: none;
    }


  </style>
</head>
<body>
  <!-- Night Mode slide switch (top-right) -->
  <div class="mode-toggle">
    <span class="label">‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô</span>
    <div id="themeToggle" class="toggle" role="switch" aria-checked="false" tabindex="0"></div>
  </div>

  <button id="loginBtn"
  class="btn btn-outline-primary btn-sm d-flex align-items-center justify-content-center"
  style="
    position:fixed;
    top:18px;
    left:18px;
    z-index:2000;
    width:42px;
    height:42px;
    border-radius:50%;
  "
  title="Login">
  <i class="bi bi-person-fill fs-5"></i>
</button>

  <div id="profileMenu"
     class="position-fixed d-none"
     style="
       top:68px;
       left:18px;
       width:180px;
       z-index:2100;
     ">
  <div class="card shadow-sm">
    <div class="list-group list-group-flush">
      <button class="list-group-item list-group-item-action" id="profileBtn">
        <i class="bi bi-person me-2"></i> Profile
      </button>
      <button class="list-group-item list-group-item-action" id="historyBtn">
        <i class="bi bi-clock-history me-2"></i> History
      </button>
      <button class="list-group-item list-group-item-action text-danger" id="logoutBtn">
        <i class="bi bi-box-arrow-right me-2"></i> Logout
      </button>
    </div>
  </div>
</div>

<div class="modal fade" id="loginModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body p-0">
        <div class="auth-wrapper">

          <!-- LOGIN -->
          <div id="loginPage" class="auth-page">
            <div class="p-4">
              <button id="googleLoginBtn" class="btn btn-danger w-100 mb-3">
                Login with Google
              </button>

              <hr>

              <input id="loginEmail" class="form-control mb-2" placeholder="Email">
              <input id="loginPassword" type="password" class="form-control mb-2" placeholder="Password">

              <button id="emailLoginBtn" class="btn btn-primary w-100 mb-2">
                Login with Email
              </button>

              <button id="goRegisterBtn" class="btn btn-link w-100 text-decoration-none">
                ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
              </button>
            </div>
          </div>

          <!-- REGISTER -->
          <div id="registerPage" class="auth-page d-none">
            <div class="p-4">
              <button id="backToLoginBtn" class="btn btn-link p-0 mb-2 text-decoration-none">
                <i class="bi bi-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
              </button>

              <h5 class="mb-1">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h5>
              <p class="text-muted small mb-3">
                ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå
              </p>

              <input id="regEmail" class="form-control mb-2" placeholder="Email">
              <input id="regPassword" type="password" class="form-control mb-1" placeholder="Password">

              <div class="text-muted small mb-3">
                ‚Ä¢ ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 6 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£<br>
                ‚Ä¢ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô
              </div>

              <button id="registerBtn" class="btn btn-success w-100">
                ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
              </button>
            </div>
          </div>

        </div>
      </div>

    </div> 
  </div>   
</div>    

        

  <div class="app container">
    <h2 class="text-center brand mb-3">Phishing URL Checker</h2>

    <!-- URL + RESULT -->
    <div class="url-wrap">
      <label for="urlInput" class="form-label mb-2">URL</label>
      <input id="urlInput" type="text" class="form-control" placeholder="https://example.com">
      <div id="resultMsg" class="result-alert d-none"></div>

      <div id="resultExplanation" class="result-alert d-none">
        <p class="mb-0">‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏• ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ö‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ñ‡∏π‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏Å‡∏±‡∏ô ‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á</p>
      </div>
    </div>

    <!-- 3 columns -->
    <div id="tri" class="tri">
      <!-- LEFT: Website Info -->
      <section id="panelInfo" class="panel">
        <div class="head">
          <div class="title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"/><path d="M2 12h20"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
            <span>WhoIS</span>
          </div>
          <button class="lock" id="lockInfo" title="‡∏•‡πá‡∏≠‡∏Ñ/‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ">
            <svg id="iconInfo" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <!-- unlocked default -->
              <rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 9.9-1"/>
            </svg>
          </button>
        </div>
        <div class="drawer">
          <div class="drawer-inner">
            <h6 id="whoisHeader" class="mb-1">üåê ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• WHOIS / ‡πÇ‡∏î‡πÄ‡∏°‡∏ô</h6>
            <ul id="whoisList" class="list mb-3"></ul>

            <h6 id="sslHeader" class="mb-1">üîí ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL</h6>
            <ul id="sslList" class="list"></ul>
          </div>
        </div>
      </section>

      <!-- CENTER: Check -->
      <div class="d-flex align-items-center justify-content-center">
        <button id="checkBtn" class="round-btn" disabled>
          <div class="spinner"></div>
          <div>Check</div>
          <div class="pct" id="pctText">0%</div>
        </button>
      </div>

      <!-- Disclaimer Button -->
      <div id="disclaimerBtnContainer" class="text-center d-none">
        <button id="disclaimerBtn" class="btn btn-danger">Disclaimer</button>
      </div>

      <!-- RIGHT: Reasons -->
      <section id="panelReason" class="panel">
        <div class="head">
          <div class="title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="18" height="18" rx="2"/><path d="M7 3v18M17 3v18M3 9h18M3 15h18"/>
            </svg>
            <span>Model Reasoning</span>
          </div>
          <button class="lock" id="lockReason" title="‡∏•‡πá‡∏≠‡∏Ñ/‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ">
            <svg id="iconReason" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <!-- unlocked default -->
              <rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 9.9-1"/>
            </svg>
          </button>
        </div>
        <div class="drawer">
          <div class="drawer-inner">
            <ul id="reasonsList" class="list"></ul>
          </div>
        </div>
      </section>
    </div>
  </div>

  <script>
    /* ====== Theme Toggle (Light default, slide to Night) ====== */
    const themeToggle = document.getElementById('themeToggle');
    const LS_KEY = 'phish_theme'; // 'light' | 'dark'

    function applyTheme(mode){
      if(mode === 'dark'){
        document.documentElement.classList.add('theme-dark');
        themeToggle.classList.add('active');
        themeToggle.setAttribute('aria-checked','true');
      }else{
        document.documentElement.classList.remove('theme-dark');
        themeToggle.classList.remove('active');
        themeToggle.setAttribute('aria-checked','false');
      }
    }
    // init from localStorage (default light)
    applyTheme(localStorage.getItem(LS_KEY) || 'light');

    function toggleTheme(){
      const isDark = document.documentElement.classList.toggle('theme-dark');
      themeToggle.classList.toggle('active', isDark);
      themeToggle.setAttribute('aria-checked', isDark ? 'true' : 'false');
      localStorage.setItem(LS_KEY, isDark ? 'dark' : 'light');
    }
    themeToggle.addEventListener('click', toggleTheme);
    themeToggle.addEventListener('keydown', (e)=>{ if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleTheme(); } });

    /* ====== App logic (unchanged core, adjusted colors by CSS vars) ====== */
    const tri          = document.getElementById("tri");
    const urlInput     = document.getElementById("urlInput");
    const checkBtn     = document.getElementById("checkBtn");
    const pctText      = document.getElementById("pctText");
    const reasonsList  = document.getElementById("reasonsList");
    const resultMsg    = document.getElementById("resultMsg");
    const panelInfo    = document.getElementById("panelInfo");
    const panelReason  = document.getElementById("panelReason");
    const lockInfoBtn  = document.getElementById("lockInfo");
    const lockReasonBtn= document.getElementById("lockReason");
    const iconInfo     = document.getElementById("iconInfo");
    const iconReason   = document.getElementById("iconReason");
    const whoisList    = document.getElementById("whoisList");
    const sslList      = document.getElementById("sslList");
    const whoisHeader  = document.getElementById("whoisHeader");
    const sslHeader    = document.getElementById("sslHeader");

    // Enable button on input / Enter to submit
    function setBtnState(){
      const hasText = urlInput.value.trim().length > 0;
      checkBtn.disabled = !hasText;
      checkBtn.classList.toggle("active", hasText);
    }
    urlInput.addEventListener("input", setBtnState);
    urlInput.addEventListener("keydown", (e)=>{
      if(e.key === "Enter" && !checkBtn.disabled){ checkBtn.click(); }
    });
    setBtnState();

    /* Hover reveal */
    function setPeek(state){
      tri.classList.remove("peek-left","peek-right");
      if(state) tri.classList.add(state);
    }
    tri.addEventListener("mousemove", (e)=>{
      const rectBtn = checkBtn.getBoundingClientRect();
      const centerX = rectBtn.left + rectBtn.width/2;
      const threshold = 20;
      if(e.clientX < centerX - threshold)      setPeek("peek-left");
      else if(e.clientX > centerX + threshold) setPeek("peek-right");
      else                                     setPeek(null);
    });
    tri.addEventListener("mouseleave", ()=> setPeek(null));

    /* Lock buttons */
    const LOCKED_SVG = '<path d="M7 11V7a5 5 0 0 1 10 0v4" /><rect x="3" y="11" width="18" height="11" rx="2"/>';
    const UNLOCK_SVG = '<rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 9.9-1"/>';
    function toggleLock(panel, iconEl, btnEl){
      const isLocked = panel.classList.toggle('locked');
      iconEl.innerHTML = isLocked ? LOCKED_SVG : UNLOCK_SVG;
      btnEl.title = isLocked ? '‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ' : '‡∏•‡πá‡∏≠‡∏Ñ';
    }
    lockInfoBtn.addEventListener('click', ()=> toggleLock(panelInfo, iconInfo, lockInfoBtn));
    lockReasonBtn.addEventListener('click', ()=> toggleLock(panelReason, iconReason, lockReasonBtn));

    /* Progress animation */
    let timer=null, p=0;
    function startProgress(){
      p=0; pctText.textContent="0%";
      checkBtn.classList.add("loading");
      if(timer) clearInterval(timer);
      timer=setInterval(()=>{
        p = Math.min(90, p + Math.max(1, Math.round((100-p)*0.06)));
        pctText.textContent = p + "%";
      },100);
    }
    function finishProgress() {
      if(timer) clearInterval(timer);
      p=100; pctText.textContent="100%";
      setTimeout(() => {
        checkBtn.classList.remove("loading");
        showExplanation();
        showDisclaimerButton();
      }, 220);
    }
    function failProgress(){
      if(timer) clearInterval(timer);
      checkBtn.classList.remove("loading");
    }

    function showExplanation(){ document.getElementById("resultExplanation").classList.remove("d-none"); }
    function showDisclaimerButton(){ document.getElementById("disclaimerBtnContainer").classList.remove("d-none"); }
    document.getElementById('disclaimerBtn')?.addEventListener('click', function() {
      const currentUrl = urlInput.value.trim();
      if (!currentUrl) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å URL'); return; }
      window.location.href = "disclaimerPopup.html?url=" + encodeURIComponent(currentUrl);
    });

    /* banner */
    function showBanner(level, text){
      resultMsg.className = "result-alert " + (level || "");
      resultMsg.textContent = text || "";
      resultMsg.classList.remove("d-none");
    }

    /* fill list helper */
    function fillList(ul, entries){
      ul.innerHTML = "";
      for (const [k,v] of entries){
        const li = document.createElement("li");
        li.textContent = `${k}: ${v}`;
        ul.appendChild(li);
      }
      if(!ul.childElementCount){
        const li=document.createElement("li");
        li.textContent="‚Äî ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚Äî";
        ul.appendChild(li);
      }
    }

    function clickReveal(){
      tri.classList.add("reveal");
      setTimeout(()=> tri.classList.remove("reveal"), 700);
    }

    /* click -> call API */
    checkBtn.addEventListener("click", async ()=>{
      const url = urlInput.value.trim();
      if(!url) return;

      // reset
      fillList(whoisList, []);
      fillList(sslList, []);
      fillList(reasonsList, []);
      whoisHeader.style.display = "none";
      sslHeader.style.display   = "none";
      resultMsg.classList.add("d-none");

      clickReveal();
      startProgress();

      try{
        const token = localStorage.getItem("firebase_token");

        const resp = await fetch("/check_url/", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            ...(token ? { "Authorization": "Bearer " + token } : {})
          },
          body: JSON.stringify({ url })
        });

        if(!resp.ok) throw new Error("API error");
        const data = await resp.json();

        finishProgress();

        // level & banner
        const level = (data.result==="safe") ? "safe" :
                      (data.result==="suspicious" ? "suspicious" : "unsafe");
        showBanner(level, data.message || "");

        // Website Info
        const whoisEntries = [];
        const sslEntries   = [];
        const W = data.website_info || {};

        // WHOIS / Domain info
        if (W["‡πÇ‡∏î‡πÄ‡∏°‡∏ô"] !== undefined) whoisEntries.push(["‡πÇ‡∏î‡πÄ‡∏°‡∏ô", W["‡πÇ‡∏î‡πÄ‡∏°‡∏ô"]]);
        if (W["‡∏≠‡∏≤‡∏¢‡∏∏‡πÇ‡∏î‡πÄ‡∏°‡∏ô (‡∏ß‡∏±‡∏ô)"] !== undefined) whoisEntries.push(["‡∏≠‡∏≤‡∏¢‡∏∏‡πÇ‡∏î‡πÄ‡∏°‡∏ô (‡∏ß‡∏±‡∏ô)", W["‡∏≠‡∏≤‡∏¢‡∏∏‡πÇ‡∏î‡πÄ‡∏°‡∏ô (‡∏ß‡∏±‡∏ô)"]]);

        // SSL / Security headers / Redirect
        if (W["‡πÉ‡∏ä‡πâ HTTPS"] !== undefined) sslEntries.push(["‡πÉ‡∏ä‡πâ HTTPS", W["‡πÉ‡∏ä‡πâ HTTPS"]]);
        if (W["‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL"] !== undefined) sslEntries.push(["‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL", W["‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL"]]);
        if (W["SSL ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏ß‡∏±‡∏ô)"] !== undefined) sslEntries.push(["SSL ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏ß‡∏±‡∏ô)", W["SSL ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏ß‡∏±‡∏ô)"]]);
        if (W["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ redirect"] !== undefined) sslEntries.push(["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ redirect", W["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ redirect"]]);
        if (W["redirect ‡πÑ‡∏õ‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏≠‡∏∑‡πà‡∏ô"] !== undefined) sslEntries.push(["redirect ‡πÑ‡∏õ‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏≠‡∏∑‡πà‡∏ô", W["redirect ‡πÑ‡∏õ‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏≠‡∏∑‡πà‡∏ô"]]);
        if (W["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô SAN (‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL)"] !== undefined) sslEntries.push(["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô SAN (‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL)", W["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô SAN (‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL)"]]);
        if (W["CN ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏î‡πÄ‡∏°‡∏ô"] !== undefined) sslEntries.push(["CN ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏î‡πÄ‡∏°‡∏ô", W["CN ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏î‡πÄ‡∏°‡∏ô"]]);

        if (whoisEntries.length) {
          whoisHeader.style.display = "block";
          fillList(whoisList, whoisEntries);
        }
        if (whoisEntries.length || sslEntries.length) {
          panelInfo.classList.add('locked');
          iconInfo.innerHTML = LOCKED_SVG;
          lockInfoBtn.title = '‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ';
        }

        if (sslEntries.length) {
          sslHeader.style.display = "block";
          fillList(sslList, sslEntries);
        }

        // Reasons
        reasonsList.innerHTML="";
        if(Array.isArray(data.reasons) && data.reasons.length){
          data.reasons.forEach(r=>{
            const contrib = (typeof r.contribution==="number") ? r.contribution.toFixed(3) : r.contribution;
            const text = r.explanation ? `${r.explanation} (contrib: ${contrib})`
                                      : `${r.label || r.feature}: ${r.value} (contrib: ${contrib})`;
            const li=document.createElement("li");
            li.textContent=text;
            reasonsList.appendChild(li);
          });

          // lock right panel if reasons exist
          panelReason.classList.add('locked');
          iconReason.innerHTML = LOCKED_SVG;
          lockReasonBtn.title = '‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ';
          setPeek("peek-right");
        } else {
          const li=document.createElement("li");
          li.textContent="‚Äî ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÑ‡∏î‡πâ ‚Äî";
          reasonsList.appendChild(li);
        }

      }catch(err){
        failProgress(); 
        showBanner("unsafe", `‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${err.message}`);
      }
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script type="module">
  const loginBtn = document.getElementById("loginBtn");
  const googleLoginBtn = document.getElementById("googleLoginBtn");
  const emailLoginBtn = document.getElementById("emailLoginBtn");
  const registerBtn = document.getElementById("registerBtn");

  const loginEmail = document.getElementById("loginEmail");
  const loginPassword = document.getElementById("loginPassword");
  const regEmail = document.getElementById("regEmail");
  const regPassword = document.getElementById("regPassword");

  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import {
    getAuth,
    GoogleAuthProvider,
    signInWithPopup,
    signInWithEmailAndPassword,
    createUserWithEmailAndPassword,
    onAuthStateChanged,
    signOut
  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

  
  /* ===== Firebase Config ===== */
  const firebaseConfig = {
    apiKey: "AIzaSyDdQAevfyoRQ4F7gLNmozMrsRoW4v4EnZg",
    authDomain: "phishing-c9e6b.firebaseapp.com",
    projectId: "phishing-c9e6b",
    storageBucket: "phishing-c9e6b.firebasestorage.app",
    messagingSenderId: "977195082418",
    appId: "1:977195082418:web:4693a6e27d20ad729d9fab",
    measurementId: "G-GXV6RV8YZ4"
  };
  
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();
  
  /* ===== Modal ===== */
  const modal = new bootstrap.Modal(document.getElementById("loginModal"));
  
  const profileMenu = document.getElementById("profileMenu");

  loginBtn.onclick = () => {
    if (auth.currentUser) {
      profileMenu.classList.toggle("d-none");
    } else {
      modal.show();
    }
  };

  // ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡πâ‡∏≤‡∏á‡∏ô‡∏≠‡∏Å
  document.addEventListener("click", (e) => {
    if (!loginBtn.contains(e.target) && !profileMenu.contains(e.target)) {
      profileMenu.classList.add("d-none");
    }
  });

  document.getElementById("logoutBtn").onclick = async () => {
  await signOut(auth);
  profileMenu.classList.add("d-none");
};

document.getElementById("profileBtn").onclick = () => {
  alert("Profile (‡∏ï‡πà‡∏≠ Firestore ‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á)");
};

document.getElementById("historyBtn").onclick = () => {
  window.location.href = "/history.html";
};

  /* Google login */
  googleLoginBtn.onclick = async () => {
    await signInWithPopup(auth, provider);
  };
  
  /* Email login */
  emailLoginBtn.onclick = async () => {
    await signInWithEmailAndPassword(
      auth,
      loginEmail.value,
      loginPassword.value
    );
  };

  /* Register */
  registerBtn.onclick = async () => {
  try {
    await createUserWithEmailAndPassword(
      auth,
      regEmail.value,
      regPassword.value
    );

    alert("‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");

    // ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ login
    registerPage.classList.add("hide");
    setTimeout(() => {
      registerPage.classList.add("d-none");
      loginPage.classList.remove("d-none");
      loginPage.classList.remove("hide");
    }, 200);

  } catch (err) {
    alert(err.message);
  }
};


  
  /* Auth state */
  onAuthStateChanged(auth, async (user) => {
  if (user) {
    const token = await user.getIdToken();
    localStorage.setItem("firebase_token", token);

    const providerId = user.providerData[0]?.providerId;

    // === GOOGLE LOGIN ===
    if (providerId === "google.com" && user.photoURL) {
      loginBtn.innerHTML = `
        <img src="${user.photoURL}"
             style="width:28px;height:28px;border-radius:50%;object-fit:cover;" />
      `;
      loginBtn.className =
        "btn btn-outline-secondary btn-sm d-flex align-items-center justify-content-center profile-google";
    }

    // === EMAIL LOGIN ===
    else {
      loginBtn.innerHTML = `<i class="bi bi-person-fill fs-5"></i>`;
      loginBtn.className =
        "btn btn-success btn-sm d-flex align-items-center justify-content-center";
    }

    loginBtn.title = "Account";
    modal.hide();
  } else {
    localStorage.removeItem("firebase_token");

    loginBtn.innerHTML = `<i class="bi bi-person-fill fs-5"></i>`;
    loginBtn.className =
      "btn btn-outline-primary btn-sm d-flex align-items-center justify-content-center";
    loginBtn.title = "Login";
  }
});
const loginPage = document.getElementById("loginPage");
const registerPage = document.getElementById("registerPage");
const goRegisterBtn = document.getElementById("goRegisterBtn");
const backToLoginBtn = document.getElementById("backToLoginBtn");

goRegisterBtn.onclick = () => {
  loginPage.classList.add("hide");
  setTimeout(() => {
    loginPage.classList.add("d-none");
    registerPage.classList.remove("d-none");
    registerPage.classList.remove("hide");
  }, 200);
};

backToLoginBtn.onclick = () => {
  registerPage.classList.add("hide");
  setTimeout(() => {
    registerPage.classList.add("d-none");
    loginPage.classList.remove("d-none");
    loginPage.classList.remove("hide");
  }, 200);
};


  </script>
</body>
</html>
