<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Phishing URL Checker</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>

  <style>
    /* ========= THEME (Modern Neon / Soft) ========= */
    :root{
      --bg: #0e1117;
      --bg-grad: radial-gradient(1000px 600px at 50% -100px, #1a2236 0%, #0e1117 70%);
      --muted: #9fb3d2;
      --ink: #e9f0ff;
      --accent: #2b6bff;
      --ring: rgba(0, 186, 255, .35);
      --glass: rgba(255,255,255,.06);
      --glass-2: rgba(255,255,255,.03);
      --radius: 22px;
      --shadow: 0 20px 60px rgba(0,0,0,.45);

      /* motion */
      --from-offset: 46px;
      --panel-nudge: 24px;
      --anim-dur: .55s;
      --anim-ease: cubic-bezier(.2,.9,.2,1);
    }

    html,body{ height:100%; background:var(--bg); background-image:var(--bg-grad); }
    .app{ max-width:1180px; margin:48px auto; }

    .brand{
      font-weight:800; letter-spacing:.3px; color:#fff;
      text-shadow: 0 0 16px rgba(0,209,255,.35);
    }

    /* ===== URL BAR ===== */
    .url-wrap{
      background: linear-gradient(180deg, var(--glass), var(--glass-2));
      border-radius: var(--radius);
      box-shadow: var(--shadow), 0 0 0 1px rgba(255,255,255,.06) inset;
      padding:18px; position: relative; overflow: visible;
      backdrop-filter: blur(6px);
    }
    .form-label{ color:var(--muted); }
    .form-control{
      color:var(--ink); background:rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.08); border-radius:12px; height:52px;
      backdrop-filter: blur(8px);
    }
    .form-control::placeholder{ color:#98a2b3; }
    .form-control:focus{
      color:#fff; border-color:transparent;
      box-shadow: 0 0 0 4px var(--ring), 0 0 18px rgba(0,209,255,.25);
      background:rgba(255,255,255,.05);
    }

    /* ===== RESULT under URL ===== */
    .result-alert{
      border-radius:14px; margin-top:12px; padding:12px 14px; color:#e9eefc;
      background: linear-gradient(180deg, rgba(0,209,255,.08), rgba(255,255,255,.03));
      box-shadow: 0 0 0 1px rgba(255,255,255,.06) inset, var(--shadow);
      backdrop-filter: blur(6px);
    }
    .result-alert.safe{
      background: linear-gradient(180deg, rgba(45,255,171,.12), rgba(255,255,255,.03));
      box-shadow: 0 0 24px rgba(45,255,171,.18), 0 0 0 1px rgba(45,255,171,.25) inset;
    }
    .result-alert.suspicious{
      background: linear-gradient(180deg, rgba(255,200,0,.12), rgba(255,255,255,.03));
      box-shadow: 0 0 24px rgba(255,200,0,.18), 0 0 0 1px rgba(255,200,0,.25) inset;
    }
    .result-alert.unsafe{
      background: linear-gradient(180deg, rgba(255,77,77,.12), rgba(255,255,255,.03));
      box-shadow: 0 0 24px rgba(255,77,77,.18), 0 0 0 1px rgba(255,77,77,.25) inset;
    }

    /* ===== LAYOUT ===== */
    .tri{
      display:grid; grid-template-columns:1fr 200px 1fr; gap:24px;
      margin-top:26px; align-items:stretch; position:relative;
    }

    /* ===== ROUND CHECK BUTTON ===== */
    .round-btn{
      width:200px; height:200px; border-radius:999px; border:0;
      background: radial-gradient(115% 115% at 30% 20%, #28418b, #1c2c64 70%);
      color:#f7f9ff; font-weight:800; letter-spacing:.2px;
      box-shadow:
        inset 0 30px 90px rgba(255,255,255,.06),
        0 16px 40px rgba(0,0,0,.55),
        0 0 48px rgba(0, 186, 255, .25);
      transition: transform .22s ease, box-shadow .22s ease;
      display:flex; align-items:center; justify-content:center; flex-direction:column;
      position:relative; text-transform:uppercase; outline: 0;
    }
    .round-btn.active{
      background:
        radial-gradient(120% 120% at 30% 20%, var(--accent), #153a9b 70%),
        linear-gradient(180deg, rgba(255,255,255,.1), transparent);
      box-shadow:
        0 22px 50px rgba(0,0,0,.6),
        0 0 64px rgba(0, 186, 255, .40),
        0 0 0 6px rgba(0, 186, 255, .10);
    }
    .round-btn:hover:not(:disabled),
    .round-btn:focus-visible{
      transform: translateY(-4px) scale(1.02);
      box-shadow:
        0 24px 56px rgba(0,0,0,.6),
        0 0 76px rgba(0,186,255,.45),
        0 0 0 8px rgba(0,186,255,.10);
    }
    .round-btn::after{
      content:""; position:absolute; inset:-6px; border-radius:999px; pointer-events:none;
      box-shadow: 0 0 0 2px rgba(0,186,255,.28);
      opacity:0; transform:scale(.96);
    }
    .round-btn:hover::after{ animation:ring 1.4s ease-out infinite; }
    @keyframes ring{
      0%  { opacity:.45; transform:scale(.96); }
      100%{ opacity:0;   transform:scale(1.25); }
    }
    .round-btn:disabled{ cursor:not-allowed; opacity:.8; filter:grayscale(.2); }
    .round-btn .pct{ font-size:22px; margin-top:6px; opacity:.95; }
    .spinner{
      position:absolute; inset:16px; border-radius:999px;
      border:6px solid rgba(255,255,255,.18);
      border-top-color:#fff; animation:spin .9s linear infinite; display:none;
      filter: drop-shadow(0 0 8px rgba(255,255,255,.35));
    }
    .round-btn.loading .spinner{ display:block; }
    @keyframes spin{ to{ transform:rotate(360deg); } }

    /* ===== PANELS ===== */
    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border-radius: var(--radius);
      box-shadow: 0 10px 35px rgba(0,0,0,.35);
      position: relative; padding: 12px 14px 16px;
      backdrop-filter: blur(10px) saturate(120%);
      transition: transform .5s var(--anim-ease), opacity .5s var(--anim-ease), filter .5s var(--anim-ease), box-shadow .5s var(--anim-ease);
    }
    .panel::before{
      content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none;
      box-shadow: 0 0 0 1px rgba(255,255,255,.06) inset, 0 0 24px rgba(0,186,255,.08) inset;
      transition: opacity .5s var(--anim-ease);
      opacity:.9;
    }

    #panelInfo  { transform: translateX(var(--panel-nudge));   opacity:.86; filter: blur(0.3px); }
    #panelReason{ transform: translateX(calc(var(--panel-nudge) * -1)); opacity:.86; filter: blur(0.3px); }

    .peek-left  #panelInfo,
    .peek-right #panelReason,
    .reveal #panelInfo,
    .reveal #panelReason,
    #panelInfo.locked,
    #panelReason.locked{
      transform: translateX(0);
      opacity:1;
      filter: none;
    }

    .head{ display:flex; align-items:center; justify-content:space-between; gap:8px; padding-bottom:8px; color:#e9eefc; }
    .title{ display:flex; gap:10px; align-items:center; font-weight:700; }
    .title svg{ width:18px; height:18px; color:#77cfff; }

    .lock{
      display:inline-flex; align-items:center; justify-content:center;
      width:38px; height:38px; border-radius:12px; border:0;
      background:rgba(0,0,0,.18); color:#aeb7ca; transition:all .2s ease;
      box-shadow: 0 0 0 1px rgba(255,255,255,.06) inset;
    }
    .lock:hover{ color:#e6edff; box-shadow:0 0 0 1px rgba(0,186,255,.35) inset, 0 0 14px rgba(0,186,255,.20); }
    .lock svg{ width:18px; height:18px; }

    .list{ margin:0; padding-left:18px; color:#cfe3ff; }
    .list li{ margin:.25rem 0; opacity:0.96; }

    .drawer{ position:relative; overflow:hidden; }
    .drawer-inner{ padding:6px 2px 2px; transition: transform .5s var(--anim-ease), opacity .5s var(--anim-ease), filter .5s var(--anim-ease); }

    #panelInfo  .drawer-inner{ transform: translateX(var(--from-offset));  opacity:.0; filter: blur(2px); }
    #panelReason .drawer-inner{ transform: translateX(calc(var(--from-offset) * -1)); opacity:.0; filter: blur(2px); }

    .peek-left  #panelInfo  .drawer-inner,
    .peek-right #panelReason .drawer-inner,
    .reveal #panelInfo  .drawer-inner,
    .reveal #panelReason .drawer-inner,
    #panelInfo.locked  .drawer-inner,
    #panelReason.locked .drawer-inner{
      transform: translateX(0); opacity:1; filter: blur(0);
    }

    #disclaimerBtnContainer {
      position: absolute;
      bottom: -50px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 100;
      display: block;
    }

    #panelInfo h6 { display:none; }
    h6 { color: #ffffff; text-shadow: 0 0 8px rgba(0, 186, 255, 0.6), 0 0 15px rgba(0, 186, 255, 0.8); }
  </style>
</head>
<body>
  <div class="app container">
    <h2 class="text-center brand mb-3">Phishing URL Checker</h2>

    <!-- URL + RESULT -->
    <div class="url-wrap">
      <label for="urlInput" class="form-label mb-2">URL</label>
      <input id="urlInput" type="text" class="form-control" placeholder="https://example.com">
      <div id="resultMsg" class="result-alert d-none"></div>

      <div id="resultExplanation" class="result-alert d-none">
        <p>‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏• ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ö‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ñ‡∏π‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏Å‡∏±‡∏ô ‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á</p>
      </div>
    </div>

    <!-- 3 columns -->
    <div id="tri" class="tri">
      <!-- LEFT: Website Info -->
      <section id="panelInfo" class="panel">
        <div class="head">
          <div class="title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"/><path d="M2 12h20"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
            <span>WhoIS</span>
          </div>
          <button class="lock" id="lockInfo" title="‡∏•‡πá‡∏≠‡∏Ñ/‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ">
            <svg id="iconInfo" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <!-- unlocked default -->
              <rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 9.9-1"/>
            </svg>
          </button>
        </div>
        <div class="drawer">
          <div class="drawer-inner">
            <h6 id="whoisHeader" class="mb-1">üåê ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• WHOIS / ‡πÇ‡∏î‡πÄ‡∏°‡∏ô</h6>
            <ul id="whoisList" class="list mb-3"></ul>

            <h6 id="sslHeader" class="mb-1">üîí ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL</h6>
            <ul id="sslList" class="list"></ul>
          </div>
        </div>
      </section>

      <!-- CENTER: Check -->
      <div class="d-flex align-items-center justify-content-center">
        <button id="checkBtn" class="round-btn" disabled>
          <div class="spinner"></div>
          <div>Check</div>
          <div class="pct" id="pctText">0%</div>
        </button>
      </div>

      <!-- Disclaimer Button -->
      <div id="disclaimerBtnContainer" class="text-center d-none">
        <button id="disclaimerBtn" class="btn btn-danger">Disclaimer</button>
      </div>

      <!-- RIGHT: Reasons -->
      <section id="panelReason" class="panel">
        <div class="head">
          <div class="title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="18" height="18" rx="2"/><path d="M7 3v18M17 3v18M3 9h18M3 15h18"/>
            </svg>
            <span>Model Reasoning</span>
          </div>
          <button class="lock" id="lockReason" title="‡∏•‡πá‡∏≠‡∏Ñ/‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ">
            <svg id="iconReason" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <!-- unlocked default -->
              <rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 9.9-1"/>
            </svg>
          </button>
        </div>
        <div class="drawer">
          <div class="drawer-inner">
            <ul id="reasonsList" class="list"></ul>
          </div>
        </div>
      </section>
    </div>
  </div>

  <script>
    const tri          = document.getElementById("tri");
    const urlInput     = document.getElementById("urlInput");
    const checkBtn     = document.getElementById("checkBtn");
    const pctText      = document.getElementById("pctText");
    const reasonsList  = document.getElementById("reasonsList");
    const resultMsg    = document.getElementById("resultMsg");
    const panelInfo    = document.getElementById("panelInfo");
    const panelReason  = document.getElementById("panelReason");
    const lockInfoBtn  = document.getElementById("lockInfo");
    const lockReasonBtn= document.getElementById("lockReason");
    const iconInfo     = document.getElementById("iconInfo");
    const iconReason   = document.getElementById("iconReason");
    const whoisList    = document.getElementById("whoisList");
    const sslList      = document.getElementById("sslList");
    const whoisHeader  = document.getElementById("whoisHeader");
    const sslHeader    = document.getElementById("sslHeader");

    // Enable button on input / Enter to submit
    function setBtnState(){
      const hasText = urlInput.value.trim().length > 0;
      checkBtn.disabled = !hasText;
      checkBtn.classList.toggle("active", hasText);
    }
    urlInput.addEventListener("input", setBtnState);
    urlInput.addEventListener("keydown", (e)=>{
      if(e.key === "Enter" && !checkBtn.disabled){ checkBtn.click(); }
    });
    setBtnState();

    /* Hover reveal */
    function setPeek(state){
      tri.classList.remove("peek-left","peek-right");
      if(state) tri.classList.add(state);
    }
    tri.addEventListener("mousemove", (e)=>{
      const rectBtn = checkBtn.getBoundingClientRect();
      const centerX = rectBtn.left + rectBtn.width/2;
      const threshold = 20;
      if(e.clientX < centerX - threshold)      setPeek("peek-left");
      else if(e.clientX > centerX + threshold) setPeek("peek-right");
      else                                     setPeek(null);
    });
    tri.addEventListener("mouseleave", ()=> setPeek(null));

    /* Lock buttons */
    const LOCKED_SVG = '<path d="M7 11V7a5 5 0 0 1 10 0v4" /><rect x="3" y="11" width="18" height="11" rx="2"/>';
    const UNLOCK_SVG = '<rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 9.9-1"/>';
    function toggleLock(panel, iconEl, btnEl){
      const isLocked = panel.classList.toggle('locked');
      iconEl.innerHTML = isLocked ? LOCKED_SVG : UNLOCK_SVG;
      btnEl.title = isLocked ? '‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ' : '‡∏•‡πá‡∏≠‡∏Ñ';
    }
    lockInfoBtn.addEventListener('click', ()=> toggleLock(panelInfo, iconInfo, lockInfoBtn));
    lockReasonBtn.addEventListener('click', ()=> toggleLock(panelReason, iconReason, lockReasonBtn));

    /* Progress animation */
    let timer=null, p=0;
    function startProgress(){
      p=0; pctText.textContent="0%";
      checkBtn.classList.add("loading");
      if(timer) clearInterval(timer);
      timer=setInterval(()=>{
        p = Math.min(90, p + Math.max(1, Math.round((100-p)*0.06)));
        pctText.textContent = p + "%";
      },100);
    }
    function finishProgress() {
      if(timer) clearInterval(timer);
      p=100; pctText.textContent="100%";
      setTimeout(() => {
        checkBtn.classList.remove("loading");
        showExplanation();
        showDisclaimerButton();
      }, 220);
    }
    function failProgress(){
      if(timer) clearInterval(timer);
      checkBtn.classList.remove("loading");
    }

    function showExplanation(){ document.getElementById("resultExplanation").classList.remove("d-none"); }
    function showDisclaimerButton(){ document.getElementById("disclaimerBtnContainer").classList.remove("d-none"); }
    document.getElementById('disclaimerBtn').addEventListener('click', function() {
      const currentUrl = urlInput.value.trim();
      if (!currentUrl) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å URL'); return; }
      window.location.href = "disclaimerPopup.html?url=" + encodeURIComponent(currentUrl);
    });

    /* banner */
    function showBanner(level, text){
      resultMsg.className = "result-alert " + (level || "");
      resultMsg.textContent = text || "";
      resultMsg.classList.remove("d-none");
    }

    /* fill list helper */
    function fillList(ul, entries){
      ul.innerHTML = "";
      for (const [k,v] of entries){
        const li = document.createElement("li");
        li.textContent = `${k}: ${v}`;
        ul.appendChild(li);
      }
      if(!ul.childElementCount){
        const li=document.createElement("li");
        li.textContent="‚Äî ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚Äî";
        ul.appendChild(li);
      }
    }

    function clickReveal(){
      tri.classList.add("reveal");
      setTimeout(()=> tri.classList.remove("reveal"), 700);
    }

    /* click -> call API */
    checkBtn.addEventListener("click", async ()=>{
      const url = urlInput.value.trim();
      if(!url) return;

      // reset
      fillList(whoisList, []);
      fillList(sslList, []);
      fillList(reasonsList, []);
      whoisHeader.style.display = "none";
      sslHeader.style.display   = "none";
      resultMsg.classList.add("d-none");

      clickReveal();
      startProgress();

      try{
        const resp = await fetch("/check_url/", {
          method:"POST", headers:{"Content-Type":"application/json"},
          body: JSON.stringify({url})
        });
        if(!resp.ok) throw new Error("API error");
        const data = await resp.json();

        finishProgress();

        // level & banner
        const level = (data.result==="safe") ? "safe" :
                      (data.result==="suspicious" ? "suspicious" : "unsafe");
        showBanner(level, data.message || "");

        // Website Info -> ‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô WHOIS/SSL ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏µ‡∏¢‡πå‡∏ó‡∏µ‡πà app.py ‡∏≠‡∏≤‡∏à‡∏™‡πà‡∏á
        const whoisEntries = [];
        const sslEntries   = [];
        const W = data.website_info || {};

        // WHOIS / Domain info
        if (W["‡πÇ‡∏î‡πÄ‡∏°‡∏ô"] !== undefined) whoisEntries.push(["‡πÇ‡∏î‡πÄ‡∏°‡∏ô", W["‡πÇ‡∏î‡πÄ‡∏°‡∏ô"]]);
        if (W["‡∏≠‡∏≤‡∏¢‡∏∏‡πÇ‡∏î‡πÄ‡∏°‡∏ô (‡∏ß‡∏±‡∏ô)"] !== undefined) whoisEntries.push(["‡∏≠‡∏≤‡∏¢‡∏∏‡πÇ‡∏î‡πÄ‡∏°‡∏ô (‡∏ß‡∏±‡∏ô)", W["‡∏≠‡∏≤‡∏¢‡∏∏‡πÇ‡∏î‡πÄ‡∏°‡∏ô (‡∏ß‡∏±‡∏ô)"]]);

        // SSL / Security headers / Redirect ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà app.py ‡∏≠‡∏≤‡∏à‡πÉ‡∏™‡πà‡∏°‡∏≤
        if (W["‡πÉ‡∏ä‡πâ HTTPS"] !== undefined) sslEntries.push(["‡πÉ‡∏ä‡πâ HTTPS", W["‡πÉ‡∏ä‡πâ HTTPS"]]);
        if (W["‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL"] !== undefined) sslEntries.push(["‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL", W["‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL"]]);
        if (W["SSL ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏ß‡∏±‡∏ô)"] !== undefined) sslEntries.push(["SSL ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏ß‡∏±‡∏ô)", W["SSL ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏ß‡∏±‡∏ô)"]]);
        if (W["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ redirect"] !== undefined) sslEntries.push(["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ redirect", W["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ redirect"]]);
        if (W["redirect ‡πÑ‡∏õ‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏≠‡∏∑‡πà‡∏ô"] !== undefined) sslEntries.push(["redirect ‡πÑ‡∏õ‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏≠‡∏∑‡πà‡∏ô", W["redirect ‡πÑ‡∏õ‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏≠‡∏∑‡πà‡∏ô"]]);
        if (W["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô SAN (‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL)"] !== undefined) sslEntries.push(["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô SAN (‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL)", W["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô SAN (‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL)"]]);
        if (W["CN ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏î‡πÄ‡∏°‡∏ô"] !== undefined) sslEntries.push(["CN ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏î‡πÄ‡∏°‡∏ô", W["CN ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏î‡πÄ‡∏°‡∏ô"]]);

        if (whoisEntries.length) {
          whoisHeader.style.display = "block";
          fillList(whoisList, whoisEntries);
        }
        if (sslEntries.length) {
          sslHeader.style.display = "block";
          fillList(sslList, sslEntries);
        }

        // Reasons (treeinterpreter)
        // Reasons (treeinterpreter)
      reasonsList.innerHTML="";
      if(Array.isArray(data.reasons) && data.reasons.length){
        data.reasons.forEach(r=>{
          const contrib = (typeof r.contribution==="number") ? r.contribution.toFixed(3) : r.contribution;
          const text = r.explanation ? `${r.explanation} (contrib: ${contrib})`
                                    : `${r.label || r.feature}: ${r.value} (contrib: ${contrib})`;
          const li=document.createElement("li");
          li.textContent=text;
          reasonsList.appendChild(li);
        });

        // üëá ‡πÉ‡∏´‡πâ‡πÇ‡∏ä‡∏ß‡πå‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤‡πÅ‡∏ö‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏°‡∏µ reasons
        panelReason.classList.add('locked');
        iconReason.innerHTML = LOCKED_SVG;
        lockReasonBtn.title = '‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ';
        setPeek("peek-right"); // ‡∏î‡∏±‡∏ô‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á

      } else {
        const li=document.createElement("li");
        li.textContent="‚Äî ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÑ‡∏î‡πâ ‚Äî";
        reasonsList.appendChild(li);
      }
    
      }catch(err){
        failProgress();
        showBanner("unsafe", `‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${err.message}`);
      }
    });
  </script>
</body>
</html>
